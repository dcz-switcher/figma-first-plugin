<style>
  *{
    margin: 0;
    padding: 0;
    font-family: 'Inter', 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
  }

  .skin-color1{ background-color: #5396FA; }
  .skin-color2{ background-color: #FFCF37; }
  .skin-color3{ background-color: #F6D3B5; }
  .skin-color4{ background-color: #EDB893; }
  .skin-color5{ background-color: #916441; }
  .skin-color6{ background-color: #402E23; }

  #container{
    background-color: #fff;
    color: white;
  }

  #preview{
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 16px;
    height: 150px;
  }

  #layer-stack{
    position: relative;
    width: 98px;
    height: 108px;
  }

  .layer{
    position: absolute;
    top: 0;
    left: 0;
  }

  #eye-layer{
    left: 18px;
    top: 30px;
  }

  #properties{
    text-align: center;
    color: #5396FA;
    font-weight: bold;
    font-size: 16px;
    padding: 16px 0;
    border-bottom: 1px solid #E5E5E5;
    margin-bottom: 16px;
  }

  #colors{
    padding: 0 16px;
    display: flex;
    justify-content: space-between;
  }

  .color-circle{
    width: 36px;
    height: 36px;
    border-radius: 100%;
    cursor: pointer;    
  }


  .radio-wrap{
    position: relative;
  }

  #colors input[type=radio]{
    display: none;
  }

  #colors label{
    width: 36px;
    height: 36px;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 10;
    cursor: pointer;
  }

  .radio-skin{
    display: block;
    position: relative;
    width: 36px;
    height: 36px;
    border-radius: 100%;
  }

  .radio-skin::after{
    display: block;
    position: relative;
    content: '';
    width: 46px;
    height: 46px;
    top: -9px;
    left: -9px;
    border-radius: 100%;
  }

  #colors input[type=radio]:checked ~ .radio-skin::after{
    border: 4px solid #5A5A5F;
  }




  #actions{
    padding: 16px;
    text-align: right;
  }

  button {
    height: 30px;
    width: 64px;
    box-sizing: border-box;
    border-radius: 6px;
    font-style: normal;
    font-size: 13px;
    text-align: center;
    border: none;
  }
  #cancel{
    border: 1px solid rgba(255, 255, 255, 0.8);
    color: white;
    background: none;
  }

  #create{
    background: #18A0FB;
    color: white;
  }
 
</style>

<div id="container">
  <!-- 
    <p>Count: <input id="count" value="5"></p>
  -->
  <section id="preview">
    <div id="layer-stack">
      <div class="layer" id="head-layer"></div>
      <div class="layer" id="eye-layer"></div>
    </div>
  </section>
  
  <section id="properties">
    <div>Peau</div>
  </section>

  <section id="colors">
    <div class="radio-wrap">
      <input type="radio" id="color-1" name="skin-color" value="#5396FA">
      <label for="color-1"></label>
      <div class="radio-skin skin-color1"></div>
    </div>
    <div class="radio-wrap">
      <input type="radio" id="color-2" name="skin-color" checked="checked" value="#FFCF37">
      <label for="color-2"></label>
      <div class="radio-skin skin-color2"></div>
    </div>
    <div class="radio-wrap">
      <input type="radio" id="color-3" name="skin-color" value=" #F6D3B5">
      <label for="color-3"></label>
      <div class="radio-skin skin-color3"></div>
    </div>
    <div class="radio-wrap">
      <input type="radio" id="color-4" name="skin-color" value="#EDB893">
      <label for="color-4"></label>
      <div class="radio-skin skin-color4"></div>
    </div>
    <div class="radio-wrap">
      <input type="radio" id="color-5" name="skin-color" value="#916441">
      <label for="color-5"></label>
      <div class="radio-skin skin-color5"></div>
    </div>
    <div class="radio-wrap">
      <input type="radio" id="color-6" name="skin-color" value=" #402E23">
      <label for="color-6"></label>
      <div class="radio-skin skin-color6"></div>
    </div>
  </section>
  
  <section id="actions">
    <button id="cancel">Cancel</button>
    <button id="create">Create</button>
  </section>


</div>



<script>

  const HEAD = '<svg width="98" height="108" viewBox="0 0 98 108" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.0182 39.0711C10.0182 17.4927 27.511 0 49.0894 0C70.6678 0 88.1605 17.4927 88.1605 39.0711V40.3612C93.6109 40.4564 98 44.8964 98 50.3596C98 55.8229 93.6109 60.2629 88.1605 60.3581V68.9289C88.1605 90.5073 70.6678 108 49.0894 108C27.511 108 10.0182 90.5073 10.0182 68.9289V60C4.48532 60 0 55.5228 0 50C0 44.4772 4.48532 40 10.0182 40V39.0711Z" fill="#F3C09A"/></svg>';
  const EYE_1 = '<svg width="62" height="36" viewBox="0 0 62 36" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5.11731" y="1.70374" width="22" height="32" rx="11" fill="white"/><rect x="36" y="2" width="22" height="32" rx="11" fill="white"/><rect x="13.0432" y="9.62964" width="10" height="16" rx="5" fill="#434243"/><rect x="39.963" y="9.9259" width="10" height="16" rx="5" fill="#434243"/></svg>';
  const EYE_2 = '<svg width="62" height="36" viewBox="0 0 62 36" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.11731 18V22.7037C5.11731 28.7789 10.0422 33.7037 16.1173 33.7037C22.1924 33.7037 27.1173 28.7789 27.1173 22.7037V18H5.11731Z" fill="white"/><path fill-rule="evenodd" clip-rule="evenodd" d="M13.0432 18V20.6296C13.0432 23.3911 15.2818 25.6296 18.0432 25.6296C20.8046 25.6296 23.0432 23.3911 23.0432 20.6296V18H13.0432Z" fill="#434243"/><path fill-rule="evenodd" clip-rule="evenodd" d="M36 18V23C36 29.0751 40.9249 34 47 34C53.0751 34 58 29.0751 58 23V18H36Z" fill="white"/><path fill-rule="evenodd" clip-rule="evenodd" d="M39.963 18V20.9259C39.963 23.6873 42.2016 25.9259 44.963 25.9259C47.7244 25.9259 49.963 23.6873 49.963 20.9259V18H39.963Z" fill="#434243"/></svg>';

  let $preview = document.querySelector('#preview');
  let $headLayer = $preview.querySelector('#head-layer');
  let $eyeLayer = document.querySelector('#eye-layer');

  /** avatar preview init */
  document.addEventListener('DOMContentLoaded', () => {
   $headLayer.innerHTML = HEAD;
   $eyeLayer.innerHTML = EYE_1;
  });


  /** Change head color */
  document.querySelectorAll("input[name='skin-color']").forEach((el) => {
    el.addEventListener('change', function() {
      $headLayer.firstChild.firstChild.setAttribute('fill', document.querySelector("input[name='skin-color']:checked").value);
    })
  });


  /** create avatar in Figma */
  document.getElementById('create').onclick = () => {
    /*
    const textbox = document.getElementById('count');
    const count = parseInt(textbox.value, 10);
    parent.postMessage({ pluginMessage: { type: 'create-rectangles', count } }, '*')
    */
  const skinColor = document.querySelector("input[name='skin-color']:checked").value;
    parent.postMessage({ pluginMessage: { type: 'create-avatar', skinColor } }, '*');
  }

  document.getElementById('cancel').onclick = () => {
    parent.postMessage({ pluginMessage: { type: 'cancel' } }, '*')
  }

</script>
